<div class="row">
  <div class="col-md-4 col-md-offset-4">
    <div class="panel panel-info">
      <div class="panel-heading">
        <h3 class="text-center">新用户</h3>
      </div>
      <div class="panel-body">

    <div class="form-group">
    <label class="col-sm-4 control-label">校园卡照片</label>
      <div class="col-sm-8">
        <div class="input-group">
          <input type="file" id="doc-form-file">
        </div>
      </div>
    </div>

    <button type="submit" class="btn btn-default btn-block" onclick="base64_uploading()">验证</button>
      </div>
    </div>
  </div>
<script>
    var base64;
    $('#doc-form-file').change(function (){
        var fileNames = '';
        $.each(this.files, function() {
            fileNames += '<span class="am-badge">' + this.name + '</span> ';
        });
        $('#file-list').html(fileNames);
        var file = this.files[0];
        if( file.size > 5*1024*1024 ){
            alert( "你上传的文件太大了！" )
        }
        var reader=new FileReader();
        reader.onload = function(){
            base64 = reader.result;
        }
        reader.readAsDataURL(file);

    });

    //AJAX上传base64
    function base64_uploading(){
        $.ajax({
            type: 'POST',
            url: "/users/mobileUpload",
            data: {
                'base64': base64,
                'uuid': '<%= @uuid %>'
            },
            dataType: 'json',
            timeout: 10000,
            success: function(data){
                console.log(data);
             },
            error: function(xhr, type){
                alert(type);
            }
        });

    }
</script>

</div>